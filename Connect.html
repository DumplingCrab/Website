<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal File Transfer</title>
    <style>
        body {
            background-color: black;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 20px;
        }
        .terminal {
            border: 2px solid #00ff00;
            padding: 15px;
            width: 80%;
            max-width: 800px;
            margin: auto;
            white-space: pre;
            height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

    <div class="terminal" id="terminal-output">
        Initializing transfers...\n
    </div>

    <script>
        const transfers = [
            { filename: "backup-2025-03-08.zip", size: 2.4 * 1024, speed: 10, source: "192.168.1.45", destination: "203.0.113.7" },
            { filename: "server-logs.tar.gz", size: 350, speed: 3.2, source: "10.0.0.2", destination: "198.51.100.5" },
            { filename: "video-render.mp4", size: 8000, speed: 25, source: "172.16.254.3", destination: "203.0.113.15" }
        ];

        function formatSize(sizeMB) {
            return sizeMB > 1024 ? (sizeMB / 1024).toFixed(2) + " GB" : sizeMB.toFixed(2) + " MB";
        }

        function formatTime(seconds) {
            let h = Math.floor(seconds / 3600);
            let m = Math.floor((seconds % 3600) / 60);
            let s = Math.floor(seconds % 60);
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function updateTerminal(text) {
            const terminal = document.getElementById("terminal-output");
            terminal.innerHTML += text + "\n";
            terminal.scrollTop = terminal.scrollHeight;
        }

        function startTransfers(index = 0) {
            if (index >= transfers.length) {
                updateTerminal("\nAll transfers completed successfully!");
                return;
            }

            let transfer = transfers[index];
            let currentSpeed = transfer.speed;
            transfer.progress = 0;
            transfer.remaining = transfer.size / currentSpeed;

            updateTerminal(`\nTransfer #${index + 1}: ${transfer.filename}`);
            updateTerminal(`  Size: ${formatSize(transfer.size)}`);
            updateTerminal(`  From: ${transfer.source} -> To: ${transfer.destination}`);
            updateTerminal(`  Base Speed: ${transfer.speed.toFixed(2)} MB/s`);
            updateTerminal(`  Status: In Progress...\n`);

            function updateProgress() {
                if (transfer.progress < 100) {
                    // Speed fluctuations (±20%)
                    let speedVariance = (Math.random() * 0.4 - 0.2) * currentSpeed;
                    currentSpeed = Math.max(0.5, transfer.speed + speedVariance);

                    // Packet loss (5% chance)
                    if (Math.random() < 0.05) {
                        currentSpeed *= 0.5;
                        updateTerminal(`  ⚠ Packet loss detected. Speed reduced to ${currentSpeed.toFixed(2)} MB/s`);
                    }

                    // Connection loss (2% chance)
                    if (Math.random() < 0.02) {
                        updateTerminal(`  ❌ Connection lost. Reconnecting...`);
                        setTimeout(updateProgress, 5000); // Pause for 5 seconds
                        return;
                    }

                    // Update progress
                    transfer.progress += (currentSpeed / transfer.size) * 100;
                    transfer.remaining = Math.max(0, transfer.remaining - 1);

                    // Generate progress bar
                    let bar = "[" + "=".repeat(Math.floor(transfer.progress / 5)) + " ".repeat(20 - Math.floor(transfer.progress / 5)) + "]";
                    updateTerminal(`  ${bar} ${transfer.progress.toFixed(1)}% - ETA: ${formatTime(transfer.remaining)}`);

                    setTimeout(updateProgress, 1000);
                } else {
                    updateTerminal(`  ✅ ${transfer.filename} - Completed!`);
                    startTransfers(index + 1); // Start next transfer after this one finishes
                }
            }

            updateProgress();
        }

        setTimeout(() => {
            updateTerminal("\nTransfers initialized. Starting now...\n");
            startTransfers();
        }, 2000);
    </script>

</body>
</html>
